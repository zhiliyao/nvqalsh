#!/bin/bash
make clean
make
rm *.o

# ------------------------------------------------------------------------------
#  Parameters
# ------------------------------------------------------------------------------
dname=Mnist
n=60000
qn=100
d=50
c=2.0
dPath=./data/${dname}/${dname}

# ------------------------------------------------------------------------------
#  Running Scripts
# ------------------------------------------------------------------------------
p=2.0
z=0.0

oPath=./results${c}/${dname}/L${p}/

# --------------------------------------------------------------------------
#  Write NVM data
# --------------------------------------------------------------------------
./qalsh -alg 6 -n ${n} -qn ${qn} -d ${d} -p ${p} -ds ${dPath}.ds \
-qs ${dPath}.q -ts ${dPath}.gt${p} -op ${oPath}

# --------------------------------------------------------------------------
#  Ground Truth
# --------------------------------------------------------------------------
./qalsh -alg 0 -n ${n} -qn ${qn} -d ${d} -p ${p} -ds ${dPath}.ds \
    -qs ${dPath}.q -ts ${dPath}.gt${p}

# --------------------------------------------------------------------------
#  QALSH
# --------------------------------------------------------------------------
./qalsh -alg 2 -n ${n} -qn ${qn} -d ${d} -p ${p} -z ${z} -c ${c} \
    -ds ${dPath}.ds -qs ${dPath}.q -ts ${dPath}.gt${p} -op ${oPath} -k 100

# --------------------------------------------------------------------------
#  QALSH_TREE
# --------------------------------------------------------------------------
./qalsh -alg 5 -n ${n} -qn ${qn} -d ${d} -p ${p} -z ${z} -c ${c} \
    -ds ${dPath}.ds -qs ${dPath}.q -ts ${dPath}.gt${p} -op ${oPath} -k 100

# --------------------------------------------------------------------------
#  Linear Scan
# --------------------------------------------------------------------------
./qalsh -alg 3 -n ${n} -qn ${qn} -d ${d} -p ${p} -ds ${dPath}.ds \
    -qs ${dPath}.q -ts ${dPath}.gt${p} -op ${oPath}

# --------------------------------------------------------------------------
#  Test Recover TREE
# --------------------------------------------------------------------------
./qalsh -alg 9 -n ${n} -qn ${qn} -d ${d} -p ${p} -z ${z} -c ${c} \
    -ds ${dPath}.ds -qs ${dPath}.q -ts ${dPath}.gt${p} -op ${oPath}
